"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _defineProperty(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var i=0;i<e.length;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function _createClass(t,e,i){return e&&_defineProperties(t.prototype,e),i&&_defineProperties(t,i),t}function _classPrivateMethodGet(t,e,i){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return i}!function(t,e){var i={fail:"danger",success:"success",wait:"info",request:"primary",confirm:"warning",info:"info"},o={fail:"danger",success:"success",wait:"info",request:"primary",confirm:"warning",info:"info"},n={danger:"white",success:"white",info:"white",primary:"white",warning:"dark"},a=window.Laravel.dialog.defaultTitles,l=window.Laravel.dialog.defaultContent,s=t.mk("div").attr({class:"modal fade",tabindex:-1,role:"dialog","aria-labelledby":"dialogHeader",id:"dialogOverlay"}).html('<div class="modal-dialog" role="document" id="dialogBox">\n\t\t\t<div class="modal-content">\n\t\t\t\t<div class="modal-header">\n\t\t\t\t\t<h4 class="modal-title" id="dialogHeader"></h4>\n\t\t\t\t</div>\n\t\t\t\t<div class="modal-body" id="dialogContent"></div>\n\t\t\t\t<div class="modal-footer" id="dialogButtons"></div>\n\t\t\t</div>\n\t\t</div>'),r=new WeakSet,c=function(){function i(){_classCallCheck(this,i),r.add(this),this.$dialogOverlay=t("#dialogOverlay"),this.$dialogContent=t("#dialogContent"),this.$dialogHeader=t("#dialogHeader"),this.$dialogBox=t("#dialogBox"),this.$dialogButtons=t("#dialogButtons"),this._open=this.$dialogContent.length?{}:e,this._closeButton=_defineProperty({},window.Laravel.dialog.close,(function(){t.Dialog.close()})),this._$focusedElement=e}return _createClass(i,[{key:"isOpen",value:function(){return"object"===_typeof(this._open)}},{key:"fail",value:function(t,e,i){_classPrivateMethodGet(this,r,d).call(this,"fail",t,e,this._closeButton,!0===i)}},{key:"success",value:function(e,i,o,n){var a;!0===o?a=this._closeButton:t.isArray(o)&&(a={},t.each(o,(function(t,e){!function(t){a[t.html()]=function(){t.trigger("click")}}(e)}))),_classPrivateMethodGet(this,r,d).call(this,"success",e,i,a,n)}},{key:"wait",value:function(i,o,n){"boolean"==typeof o&&void 0===n&&(n=o,o=e),"string"!=typeof o&&(o=l.wait),_classPrivateMethodGet(this,r,d).call(this,"wait",i,t.capitalize(o)+"&hellip;",!0===n)}},{key:"request",value:function(t,i,o,n){"function"==typeof o&&void 0===n&&(n=o,o=e);var a,l={},s=this;if(i instanceof jQuery)a=i.attr("id");else if("string"==typeof i){var c=i.match(/<form\sid=["']([^"']+)["']/);c&&(a=c[1])}!1!==o?(a&&(l[o||window.Laravel.dialog.submit]={submit:!0,form:a}),l[window.Laravel.dialog.cancel]=function(){s.close()}):l[window.Laravel.dialog.close]={action:function(){s.close()},form:a},_classPrivateMethodGet(this,r,d).call(this,"request",t,i,l,n)}},{key:"confirm",value:function(e,i,o,n){"function"==typeof o&&void 0===n&&(n=o);var a=this;"function"!=typeof n&&(n=function(t){t&&a.close()}),t.isArray(o)||(o=[window.Laravel.dialog.yes,window.Laravel.dialog.no]);var l={};l[o[0]]=function(){n(!0)},l[o[1]]=function(){n(!1),a.close()},_classPrivateMethodGet(this,r,d).call(this,"confirm",e,i,l)}},{key:"info",value:function(t,e,i){_classPrivateMethodGet(this,r,d).call(this,"info",t,e,this._closeButton,i)}},{key:"setFocusedElement",value:function(t){t instanceof jQuery&&(this._$focusedElement=t)}},{key:"_storeFocus",value:function(){if(!(void 0!==this._$focusedElement&&this._$focusedElement instanceof jQuery)){var i=t(":focus");this._$focusedElement=i.length>0?i.last():e}}},{key:"_restoreFocus",value:function(){void 0!==this._$focusedElement&&this._$focusedElement instanceof jQuery&&(this._$focusedElement.focus(),this._$focusedElement=e)}},{key:"_setFocus",value:function(){var t=this.$dialogContent.find("input,select,textarea").filter(":visible"),e=this.$dialogButtons.children();t.length>0?t.first().focus():e.length>0&&"info"!==this._open.type&&e.first().focus()}},{key:"_controlInputs",value:function(t){var e=this.$dialogContent.children(":not(#dialogButtons)").last().add(this.$dialogButtons).find("input, button, select, textarea");t?e.filter(":not(:disabled)").addClass("temp-disable").disable():e.filter(".temp-disable").removeClass("temp-disable").enable()}},{key:"close",value:function(i){if(!this.isOpen())return t.callCallback(i,!1);var o=this;this.$dialogOverlay.modal("hide").one("hidden.bs.modal",(function(){o.$dialogOverlay.remove(),o._open=e,o._restoreFocus(),t.callCallback(i)}))}},{key:"clearNotice",value:function(t){var e=this.$dialogContent.children(":not(#dialogButtons)").children(".notice:last-child");return!!e.length&&(!(void 0!==t&&!t.test(e.html()))&&(e.hide(),e.hasClass("info")&&this._controlInputs(!1),!0))}}]),i}();function d(r,c,d,f,u){var h=this;if("string"!=typeof r||void 0===i[r])throw new TypeError("Invalid dialog type: "+_typeof(r));"function"==typeof f&&"function"!=typeof u&&(u=f,f=e);var p=!1;"boolean"==typeof u?(p=u,u=e):"boolean"==typeof f&&void 0===u&&(p=f,f=e),void 0===c?c=a[r]:!1===c&&(c=e),d||(d=l[r]);var y,g={type:r,title:c,content:d||l[r],buttons:f,color:i[r]},v=Boolean(this._open),m=t.mk("div").append(g.content),b=v&&"request"===this._open.type&&["fail","wait"].includes(g.type)&&!p;if(v||(this._storeFocus(),s.clone().appendTo($body)),b){var w=(y=this.$dialogContent.children(":not(#dialogButtons)").last()).children(".notice:last-child");w.length?w.show():(w=t.mk("div").append(t.mk("p")),y.append(w)),w.attr("class","alert alert-"+o[g.type]).children("p").html(g.content).show(),this._controlInputs("wait"===g.type)}else this._open=g,this.$dialogOverlay=t("#dialogOverlay"),this.$dialogContent=t("#dialogContent"),this.$dialogHeader=t("#dialogHeader"),"string"==typeof g.title&&this.$dialogHeader.html(g.title),this.$dialogBox=t("#dialogBox"),this.$dialogButtons=t("#dialogButtons").empty(),this._controlInputs(!0),this.$dialogContent.append(m),this.$dialogButtons[g.buttons?"show":"hide"]();b||this.$dialogHeader.parent().attr("class","modal-header"+(g.color?" bg-".concat(g.color," text-").concat(n[g.color]):"")),!b&&g.buttons&&t.each(g.buttons,(function(e,i){var o=t.mk("button").attr({type:"button",class:"btn btn-"+g.color});"function"==typeof i?i={action:i}:i.form&&1===(y=t("#".concat(i.form))).length&&(o.on("click",(function(){y.find("input[type=submit]").first().trigger("click")})),y.prepend(t.mk("input").attr("type","submit").hide())),o.text(e).on("keydown",(function(e){if([Key.Enter,Key.Space].includes(e.keyCode))e.preventDefault(),o.trigger("click");else if([Key.Tab,Key.LeftArrow,Key.RightArrow].includes(e.keyCode)){e.preventDefault();var i=h.$dialogButtons.children(),n=i.filter(":focus"),a=h.$dialogContent.find(":input");t.isKey(Key.LeftArrow,e)&&(e.shiftKey=!0),n.length?e.shiftKey?n.prev().length?n.prev().focus():t.isKey(Key.Tab,e)&&(a.length>0?a:i).filter(":visible").last().focus():n.next().length?n.next().focus():t.isKey(Key.Tab,e)&&a.add(i).filter(":visible").first().focus():a.add(i)[e.shiftKey?"last":"first"]().focus()}})).on("click",(function(e){e.preventDefault(),t.callCallback(i.action,[e])})),h.$dialogButtons.append(o)})),this.$dialogOverlay.modal({backdrop:"static",keyboard:!1}),this.$dialogOverlay.one("shown.bs.modal",(function(){if(h._setFocus(),Time.update(),t.callCallback(u,[y]),v){var e=h.$dialogContent.children().last();b&&(e=e.children(".notice").last()),h.$dialogOverlay.stop().animate({scrollTop:"+="+(e.position().top+parseFloat(e.css("margin-top"),10)+parseFloat(e.css("border-top-width"),10))},"fast")}}))}t.Dialog=new c,$body.on("keydown",(function(e){if(!t.Dialog.isOpen()||e.keyCode!==Key.Tab)return!0;var i=t.Dialog.$dialogContent.find(":input"),o=i.filter(e.target),n=i.index(o);if(0===o.length)e.preventDefault(),i.first().focus();else if(e.shiftKey)if(0===n)e.preventDefault(),t.Dialog.$dialogButtons.find(":last").focus();else{var a=o.parent();if(!a.is(t.Dialog.$dialogButtons))return!0;a.children().first().is(o)&&(e.preventDefault(),i.eq(i.index(o)-1).focus())}}))}(jQuery);
//# sourceMappingURL=../maps/dialog.js.map
