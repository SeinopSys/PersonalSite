"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _defineProperty(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var i=0;i<e.length;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function _createClass(t,e,i){return e&&_defineProperties(t.prototype,e),i&&_defineProperties(t,i),t}function _classPrivateMethodGet(t,e,i){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return i}!function(t,e){var i={fail:"danger",success:"success",wait:"info",request:"primary",confirm:"warning",info:"info"},o={fail:"danger",success:"success",wait:"info",request:"primary",confirm:"warning",info:"info"},n={danger:"white",success:"white",info:"white",primary:"white",warning:"dark"},a=window.Laravel.dialog.defaultTitles,l=window.Laravel.dialog.defaultContent,s=t.mk("div").attr({class:"modal fade",tabindex:-1,role:"dialog","aria-labelledby":"dialogHeader",id:"dialogOverlay"}).html('<div class="modal-dialog" role="document" id="dialogBox">\n\t\t\t<div class="modal-content">\n\t\t\t\t<div class="modal-header">\n\t\t\t\t\t<h4 class="modal-title" id="dialogHeader"></h4>\n\t\t\t\t</div>\n\t\t\t\t<div class="modal-body" id="dialogContent"></div>\n\t\t\t\t<div class="modal-footer" id="dialogButtons"></div>\n\t\t\t</div>\n\t\t</div>'),r=function(){function e(){_classCallCheck(this,e),d.add(this),this.$dialogOverlay=t("#dialogOverlay"),this.$dialogContent=t("#dialogContent"),this.$dialogHeader=t("#dialogHeader"),this.$dialogBox=t("#dialogBox"),this.$dialogButtons=t("#dialogButtons"),this._open=this.$dialogContent.length?{}:void 0,this._closeButton=_defineProperty({},window.Laravel.dialog.close,(function(){t.Dialog.close()})),this._$focusedElement=void 0}return _createClass(e,[{key:"isOpen",value:function(){return"object"===_typeof(this._open)}},{key:"fail",value:function(t,e,i){_classPrivateMethodGet(this,d,c).call(this,"fail",t,e,this._closeButton,!0===i)}},{key:"success",value:function(e,i,o,n){var a;!0===o?a=this._closeButton:t.isArray(o)&&(a={},t.each(o,(function(t,e){!function(t){a[t.html()]=function(){t.trigger("click")}}(e)}))),_classPrivateMethodGet(this,d,c).call(this,"success",e,i,a,n)}},{key:"wait",value:function(e,i,o){"boolean"==typeof i&&void 0===o&&(o=i,i=void 0),"string"!=typeof i&&(i=l.wait),_classPrivateMethodGet(this,d,c).call(this,"wait",e,t.capitalize(i)+"&hellip;",!0===o)}},{key:"request",value:function(t,e,i,o){"function"==typeof i&&void 0===o&&(o=i,i=void 0);var n,a={},l=this;if(e instanceof jQuery)n=e.attr("id");else if("string"==typeof e){var s=e.match(/<form\sid=["']([^"']+)["']/);s&&(n=s[1])}!1!==i?(n&&(a[i||window.Laravel.dialog.submit]={submit:!0,form:n}),a[window.Laravel.dialog.cancel]=function(){l.close()}):a[window.Laravel.dialog.close]={action:function(){l.close()},form:n},_classPrivateMethodGet(this,d,c).call(this,"request",t,e,a,o)}},{key:"confirm",value:function(e,i,o,n){"function"==typeof o&&void 0===n&&(n=o);var a=this;"function"!=typeof n&&(n=function(t){t&&a.close()}),t.isArray(o)||(o=[window.Laravel.dialog.yes,window.Laravel.dialog.no]);var l={};l[o[0]]=function(){n(!0)},l[o[1]]=function(){n(!1),a.close()},_classPrivateMethodGet(this,d,c).call(this,"confirm",e,i,l)}},{key:"info",value:function(t,e,i){_classPrivateMethodGet(this,d,c).call(this,"info",t,e,this._closeButton,i)}},{key:"setFocusedElement",value:function(t){t instanceof jQuery&&(this._$focusedElement=t)}},{key:"_storeFocus",value:function(){if(!(void 0!==this._$focusedElement&&this._$focusedElement instanceof jQuery)){var e=t(":focus");this._$focusedElement=e.length>0?e.last():void 0}}},{key:"_restoreFocus",value:function(){void 0!==this._$focusedElement&&this._$focusedElement instanceof jQuery&&(this._$focusedElement.focus(),this._$focusedElement=void 0)}},{key:"_setFocus",value:function(){var t=this.$dialogContent.find("input,select,textarea").filter(":visible"),e=this.$dialogButtons.children();t.length>0?t.first().focus():e.length>0&&"info"!==this._open.type&&e.first().focus()}},{key:"_controlInputs",value:function(t){var e=this.$dialogContent.children(":not(#dialogButtons)").last().add(this.$dialogButtons).find("input, button, select, textarea");t?e.filter(":not(:disabled)").addClass("temp-disable").disable():e.filter(".temp-disable").removeClass("temp-disable").enable()}},{key:"close",value:function(e){if(!this.isOpen())return t.callCallback(e,!1);var i=this;this.$dialogOverlay.modal("hide").one("hidden.bs.modal",(function(){i.$dialogOverlay.remove(),i._open=void 0,i._restoreFocus(),t.callCallback(e)}))}},{key:"clearNotice",value:function(t){var e=this.$dialogContent.children(":not(#dialogButtons)").children(".notice:last-child");return!!e.length&&(!(void 0!==t&&!t.test(e.html()))&&(e.hide(),e.hasClass("info")&&this._controlInputs(!1),!0))}}]),e}(),d=new WeakSet,c=function(e,r,d,c,f){var u=this;if("string"!=typeof e||void 0===i[e])throw new TypeError("Invalid dialog type: "+_typeof(e));"function"==typeof c&&"function"!=typeof f&&(f=c,c=void 0);var h=!1;"boolean"==typeof f?(h=f,f=void 0):"boolean"==typeof c&&void 0===f&&(h=c,c=void 0),void 0===r?r=a[e]:!1===r&&(r=void 0),d||(d=l[e]);var p,v={type:e,title:r,content:d||l[e],buttons:c,color:i[e]},y=Boolean(this._open),g=t.mk("div").append(v.content),m=y&&"request"===this._open.type&&["fail","wait"].includes(v.type)&&!h;if(y||(this._storeFocus(),s.clone().appendTo($body)),m){var b=(p=this.$dialogContent.children(":not(#dialogButtons)").last()).children(".notice:last-child");b.length?b.show():(b=t.mk("div").append(t.mk("p")),p.append(b)),b.attr("class","alert alert-"+o[v.type]).children("p").html(v.content).show(),this._controlInputs("wait"===v.type)}else this._open=v,this.$dialogOverlay=t("#dialogOverlay"),this.$dialogContent=t("#dialogContent"),this.$dialogHeader=t("#dialogHeader"),"string"==typeof v.title&&this.$dialogHeader.html(v.title),this.$dialogBox=t("#dialogBox"),this.$dialogButtons=t("#dialogButtons").empty(),this._controlInputs(!0),this.$dialogContent.append(g),this.$dialogButtons[v.buttons?"show":"hide"]();m||this.$dialogHeader.parent().attr("class","modal-header"+(v.color?" bg-".concat(v.color," text-").concat(n[v.color]):"")),!m&&v.buttons&&t.each(v.buttons,(function(e,i){var o=t.mk("button").attr({type:"button",class:"btn btn-"+v.color});"function"==typeof i?i={action:i}:i.form&&1===(p=t("#".concat(i.form))).length&&(o.on("click",(function(){p.find("input[type=submit]").first().trigger("click")})),p.prepend(t.mk("input").attr("type","submit").hide())),o.text(e).on("keydown",(function(e){if([Key.Enter,Key.Space].includes(e.keyCode))e.preventDefault(),o.trigger("click");else if([Key.Tab,Key.LeftArrow,Key.RightArrow].includes(e.keyCode)){e.preventDefault();var i=u.$dialogButtons.children(),n=i.filter(":focus"),a=u.$dialogContent.find(":input");t.isKey(Key.LeftArrow,e)&&(e.shiftKey=!0),n.length?e.shiftKey?n.prev().length?n.prev().focus():t.isKey(Key.Tab,e)&&(a.length>0?a:i).filter(":visible").last().focus():n.next().length?n.next().focus():t.isKey(Key.Tab,e)&&a.add(i).filter(":visible").first().focus():a.add(i)[e.shiftKey?"last":"first"]().focus()}})).on("click",(function(e){e.preventDefault(),t.callCallback(i.action,[e])})),u.$dialogButtons.append(o)})),this.$dialogOverlay.modal({backdrop:"static",keyboard:!1}),this.$dialogOverlay.one("shown.bs.modal",(function(){if(u._setFocus(),Time.update(),t.callCallback(f,[p]),y){var e=u.$dialogContent.children().last();m&&(e=e.children(".notice").last()),u.$dialogOverlay.stop().animate({scrollTop:"+="+(e.position().top+parseFloat(e.css("margin-top"),10)+parseFloat(e.css("border-top-width"),10))},"fast")}}))};t.Dialog=new r,$body.on("keydown",(function(e){if(!t.Dialog.isOpen()||e.keyCode!==Key.Tab)return!0;var i=t.Dialog.$dialogContent.find(":input"),o=i.filter(e.target),n=i.index(o);if(0===o.length)e.preventDefault(),i.first().focus();else if(e.shiftKey)if(0===n)e.preventDefault(),t.Dialog.$dialogButtons.find(":last").focus();else{var a=o.parent();if(!a.is(t.Dialog.$dialogButtons))return!0;a.children().first().is(o)&&(e.preventDefault(),i.eq(i.index(o)-1).focus())}}))}(jQuery);
//# sourceMappingURL=../maps/dialog.js.map
