"use strict";!function(e){var t=e("#uploads-toggle");t.on("click",(function(a){a.preventDefault();var i=t.hasClass("btn-success")?"enable":"disable",l=t.attr("data-dialogtitle"),n=t.attr("data-dialogcontent");e.Dialog.confirm(l,n,(function(t){t&&(e.Dialog.wait(!1),e.post("/uploads/setting/".concat(i),e.mkAjaxHandler((function(){if(!this.status)return e.Dialog.fail(!1,this.message);e.Dialog.success(!1,this.message),setTimeout((function(){window.location.reload()}),1500)}))))}))}));var a=e("#reveal-upload-key"),i=e("#upload-key-display"),l=e("#copy-upload-key"),n=e("#regen-upload-key"),o=i.attr("data-key"),s=/^\*+$/;i.removeAttr("data-key"),a.on("click",(function(e){e.preventDefault();var t=s.test(i.val());i.val(t?o:o.replace(/./g,"*")),a.children(".fa").toggleClass("fa-eye fa-eye-slash")})),n.on("click",(function(t){t.preventDefault();var l=e(this);e.Dialog.confirm(l.attr("title"),l.attr("data-dialogcontent"),(function(t){t&&(e.Dialog.wait(!1),e.post("/uploads/regen",e.mkAjaxHandler((function(){if(!this.status)return e.Dialog.fail(!1,this.message);o=this.upload_key,e.Dialog.close((function(){i.fadeTo(200,0,(function(){var e=s.test(i.val());i.val(e?o.replace(/./g,"*"):o),e&&a.trigger("click"),i.fadeTo(200,1)}))}))}))))}))})),i.on("click",(function(e){e.preventDefault(),i[0].select()})),l.on("click",(function(t){t.preventDefault(),e.copy(o,t)}));var c=e("#upload-list"),r=e("#noimg-alert");e("#uploaded-total");function d(t,a){var i=t.closest(".image"),l=i.attr("id").replace(/^upload-/,""),n=e.mk("div").attr("id","img-wipe-confirm").append(e.mk("p").append(t.attr("data-dialogcontent")),e.mk("div").attr("class","del-img-wrap").append(e.mk("img").attr("src",t.siblings().first().attr("href")))),o=function(t){if(t){a&&e.Dialog.wait(!1);var n=window.location.search.match(/page=(\d+)/),o=window.location.search.match(/orderby=([a-z]+)[ +](asc|desc)/i),s=[];n&&(n=parseInt(n[1],10),0===i.parent().siblings().length&&(n=Math.max(n-1,1)),s.push("page="+n)),o&&s.push("orderby="+o.slice(1).join("+")),e.post("/uploads/wipe"+(s.length?"?"+s.join("&"):""),{id:l},e.mkAjaxHandler((function(){if(!this.status)return e.Dialog.fail(!1,this.message);var t=e(this.newhtml),a=this.total,l=this.usedSpace;e.Dialog.close((function(){i.closest(".image-wrap").fadeTo(500,0,(function(){e(this).remove(),c.html(t.filter("#upload-list").children()),e(".pagination-wrapper").replaceWith(t.filter(".pagination-wrapper")),r=e("#noimg-alert"),e("#uploaded-total").text(a),e("#used-space").text(l),0===c.children().length&&(r.removeClass("hidden"),c.remove())}))}))})))}};a?e.Dialog.confirm(t.attr("data-dialogtitle"),n,o):o(!0)}function p(e,t){var a=e.closest(".image").parent();a[t?"addClass":"removeClass"]("selected");var i=a.siblings().addBack();i.removeClass("not-selected");var l=i.filter(":not(.selected)");l.length<i.length&&l.addClass("not-selected")}c.on("click",".copy-upload-link",(function(t){t.preventDefault(),e.copy(e(this).siblings().first().prop("href"),t)})),c.on("click",".wipe-upload",(function(t){t.preventDefault();var a=c.children(".selected");a.length?e.Dialog.confirm(Laravel.jsLocales.multiwipe_dialog_title,e.translatePlaceholders(Laravel.jsLocales.multiwipe_dialog_text,{cnt:a.length}),(function(t){t&&(e.Dialog.wait(!1),a.each((function(){d(e(this).find(".wipe-upload"),!1)})))})):d(e(this),!0)})).on("click",".image",(function(t){if(t.ctrlKey&&!t.altKey){t.preventDefault();var a=e(this).find(".selection input"),i=!a.prop("checked");a.prop("checked",i),p(a,i)}})).on("click",".image .selection input",(function(t){var a=e(this);t.altKey&&!t.ctrlKey?c.find(".not-selected, .selected").removeClass("not-selected selected").find(".selection input").prop("checked",!1):p(a,a.prop("checked"))})),e(document).on("keydown",(function(t){/^a$/i.test(t.key)&&t.ctrlKey&&!t.shiftKey&&!t.altKey&&(t.preventDefault(),e(".image-wrap").addClass("selected").removeClass("not-selected").find(".selection input").prop("checked",!0))}))}(jQuery);
//# sourceMappingURL=../maps/uploads.js.map
