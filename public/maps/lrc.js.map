{"version":3,"sources":["lrc.js"],"names":["_toConsumableArray","arr","_arrayWithoutHoles","_iterableToArray","_unsupportedIterableToArray","_nonIterableSpread","TypeError","iter","Symbol","iterator","Object","Array","from","isArray","_arrayLikeToArray","_slicedToArray","i","_arrayWithHoles","_iterableToArrayLimit","_nonIterableRest","o","minLen","n","prototype","toString","call","slice","constructor","name","test","len","length","arr2","_arr","_n","_d","_e","undefined","_s","_i","next","done","push","value","err","_typeof","obj","_defineProperties","target","props","descriptor","enumerable","configurable","writable","defineProperty","key","_createClass","Constructor","protoProps","staticProps","_classPrivateFieldGet","receiver","privateMap","get","_classPrivateMethodGet","privateSet","fn","has","_classPrivateFieldSet","set","_classCallCheck","instance","$","window","URL","webkitURL","pluginScope","player","editor","floatToPercent","float","roundTo","LRCString","str","arguments","ts","domNode","this","trim","Duration","$domNode","seconds","ignoreMilliseconds","_fromString","add","_ignoreMs","_fromString2","parseFloat","toFixed","Math","ceil","padMinutes","time","mins","floor","minsStr","pad","String","_time$toFixed$split","split","_time$toFixed$split2","secsStr","msStr","concat","WeakMap","WeakSet","isValid","parts","dur","pop","parseInt","NaN","AudioPlaybackIndicator","$stateDiv","_$stateDiv","_$position","_$duration","_$filename","_$filetype","_$progressFill","_$progressLoaded","_$entrySticks","_$thumb","find","$progressWrap","setFileName","setProgress","showThumb","type","text","replace","toUpperCase","position","duration","html","pos","updateSeek","timeRanges","empty","start","end","append","mk","css","left","width","entries","_this","each","_","el","perc","isPlaying","AudioPlayer","_this2","_stopUpdateIndTimer","_startUpdateIndTimer","_$player","_$filein","_$audiofilebtn","_audio","_mediatags","_volumeStep","_$volumedisp","_updateIndTimer","_stateInd","attr","accept","tabindex","class","appendTo","$body","$playbackbtn","Audio","preload","$stopbtn","on","stop","updatePlaybackButtons","updateInd","enable","updateEntrySticks","setMetadataLength","$volumedown","$volumeup","resumeOnRelease","sessionVol","getSessionVolume","volume","updateVolumeButtons","e","which","hasFile","preventDefault","addClass","paused","pause","$d","hasClass","recalcThumbPos","removeClass","play","throttle","shiftKey","altKey","newvol","trigger","val","clearFile","disable","setFile","files","file","rangeLimit","round","localStorage","setItem","fileMissing","TimingEditor","getInstance","disableModeButton","children","_startUpdateIndTimer2","skipIndUpd","_stopUpdateIndTimer2","currentTime","callback","_this3","src","createObjectURL","jsmediatags","Reader","setTagsToRead","read","onSuccess","data","setMediaTags","tags","onError","error","console","log","info","Dialog","fail","Laravel","jsLocales","dialog_format_error","dialog_format_notaudio","readyState","revokeObjectURL","clearMediaTags","title","artist","getFileName","setInitialMetadata","Error","setLoaded","buffered","hlEntry","getPlaybackPosition","setEntries","getTimings","pwOffset","offset","pwWidth","relativeX","clientX","stored","getItem","isNaN","_this10","setInterval","clearInterval","LRC_META_TAGS","ar","ti","al","au","by","re","ve","LRC_TS_REGEX","LRC_META_REGEX","RegExp","keys","join","LRCParser","lrcfile","_this4","timings","metadata","dialog_parse_error_empty","lines","timestamps","match","substring","trimmedEl","sort","a","b","MetadataEditingForm","compiledMetadata","_this5","_$form","short","long","id","inputAttrs","step","min","placeholder","for","metadata_field_placeholders","prepend","dialog_edit_meta_reset_info","dialog_edit_meta_reset_btn","clone","_this6","_updateMergeStrategyButton","_toggleMergeStrategy","_mergedOutputStrategy","_$timings","_$lrcmodebtn","_$lrcfilebtn","_$filein2","_$lrcpastebtn","_$lrcexportbtn","_$lrcexportnometabtn","_$lrcmergetogglebtn","_$lrcclrbtn","_$lrcmetadatabtn","_$editor","_$entryTemplate","_lastLRCFilename","_mode","changeMode","initialMetadata","location","href","git","commit_id","makeEntryDiv","getMergedOutputStrategyDefault","_updateMergeStrategyButton2","is","$form","dialog_pasteraw_info","request","dialog_pasteraw_title","dialog_pasteraw_action","wait","map","regenEntries","close","storeTimings","exportLRCFile","_toggleMergeStrategy2","confirm","sure","getCurrentMetadata","dialog_edit_meta","save","mkData","newMetadata","$ts","valInvalid","siblings","insertWhere","closest","$entry","updateEntryActionButtons","scrollHighlightedIntoView","remove","$button","parents","setPlaybackPosition","passSyncHandle","readLRCFile","success","mode","preservePosition","inArray","$children","modeIcon","edit","sync","otherMode","otherIcon","first","revokeSyncHandle","removeAttr","$handle","getSyncHandle","_this7","extend","lrcstring","$clone","_this8","$entries","filter","parent","_this9","reader","FileReader","onload","parsed","result","setTimings","setMetadata","dialog_parse_error","message","readAsText","nowplayingAsHandle","$nowplaying","giveSyncHandleTo","$current","$next","resetOnEnd","writeTs","$prevTs","prev","insertBefore","index","usableTimings","compare","l","r","m","comp","binarySearch","$hl","highlight","hlpos","edpos","scrl","scrollTop","newscrl","top","height","animate","includeMetadata","outputArr","k","v","strings","tsArr","output","basename","filename","blob","Blob","saveAs","$el","focus","$status","tagname","tagName","toLowerCase","getAttribute","keyCode","Key","LeftArrow","seek","RightArrow","PageUp","PageDown","Space","Period","Enter","ctrlKey","syncBreakEntry","syncEntry","UpArrow","undoSync","DownArrow","Delete","emptySync","$this","clipboardData","getData","originalEvent","document","queryCommandSupported","execCommand","setTimeout","not","contents","unwrap","$ist","navigator","userAgent","Plugin","jQuery"],"mappings":"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","file":"../js/lrc.js","sourcesContent":["/* global mk,$body,Key,Laravel,saveAs,jsmediatags */\n(function ($, undefined) {\n    \"use strict\";\n\n    window.URL = window.URL || window.webkitURL;\n\n    const pluginScope = {\n        player: undefined,\n        editor: undefined,\n    };\n\n    const LRC_TS_DECIMALS = 2;\n\n    function floatToPercent(float) {\n        return ($.roundTo(float, 5) * 100) + '%';\n    }\n\n    function binarySearch(arr, compare) { // binary search, with custom compare function\n        let l = 0,\n            r = arr.length - 1;\n        while (l <= r) {\n            // jshint -W016\n            let m = l + ((r - l) >> 1),\n                comp = compare(arr[m]);\n            if (comp < 0) // arr[m] comes before the element\n                l = m + 1;\n            else if (comp > 0) // arr[m] comes after the element\n                r = m - 1;\n            else // this[m] equals the element\n                return m;\n        }\n        return l - 1; // return the index of the next left item\n                      // usually you would just return -1 in case nothing is found\n    }\n\n    class LRCString {\n        constructor(str = '', ts = undefined, domNode = null) {\n            this.str = str.trim();\n            this.ts = ts instanceof Duration ? ts : new Duration(ts);\n            this.$domNode = domNode;\n        }\n    }\n\n    class Duration {\n        #ignoreMs;\n\n        constructor(seconds, ignoreMilliseconds = false) {\n            this.#ignoreMs = ignoreMilliseconds;\n            switch (typeof seconds) {\n                case 'string':\n                    this.#fromString(seconds);\n                    break;\n                case \"number\":\n                    this.seconds = parseFloat(parseFloat(seconds).toFixed(LRC_TS_DECIMALS));\n                    if (this.#ignoreMs)\n                        this.seconds = Math.ceil(this.seconds);\n                    break;\n            }\n        }\n\n        toString(padMinutes = false) {\n            if (typeof this.seconds === 'undefined')\n                return '';\n            let time = this.seconds;\n            const mins = Math.floor(time / 60);\n            if (mins > 0)\n                time -= mins * 60;\n            const minsStr = padMinutes ? $.pad(mins) : String(mins);\n\n            const [secsStr, msStr] = time.toFixed(LRC_TS_DECIMALS).split('.');\n            return `${minsStr}:${$.pad(secsStr)}${this.#ignoreMs ? '' : `.${msStr}`}`;\n        }\n\n        #fromString(ts) {\n            if (!Duration.isValid(ts)) {\n                this.seconds = NaN;\n                return;\n            }\n            let parts = ts.split(':');\n            let dur = parseFloat(parts.pop());\n            if (parts.length)\n                dur += parseInt(parts.pop(), 10) * 60;\n            this.seconds = dur;\n        }\n\n        static isValid(ts) {\n            return /(?:\\d+:)?[0-5]?\\d:[0-5]\\d(?:\\.\\d{1,2})?/.test(ts);\n        }\n    }\n\n    class AudioPlaybackIndicator {\n        #$stateDiv;\n        #$position;\n        #$duration;\n        #$filename;\n        #$filetype;\n        #$progressFill;\n        #$progressLoaded;\n        #$entrySticks;\n        #$thumb;\n\n        constructor($stateDiv) {\n            this.#$stateDiv = $stateDiv;\n            this.#$position = this.#$stateDiv.find('.status-position');\n            this.#$duration = this.#$stateDiv.find('.status-duration');\n            this.#$filename = this.#$stateDiv.find('.status-filename');\n            this.#$filetype = this.#$stateDiv.find('.status-filetype');\n            this.$progressWrap = this.#$stateDiv.find('.progress-wrap');\n            this.#$progressFill = this.#$stateDiv.find('.progress-indicator .fill');\n            this.#$progressLoaded = this.#$stateDiv.find('.progress-indicator .loaded');\n            this.#$entrySticks = this.#$stateDiv.find('.progress-indicator .entry-sticks');\n            this.#$thumb = this.#$stateDiv.find('.thumb');\n            this.setFileName();\n            this.setProgress();\n            this.showThumb();\n        }\n\n        setFileName(name, type) {\n            this.#$filename.text(name ? name.replace(/\\.[^.]+$/, '') : '');\n            this.#$filetype.text(type ? type.split('/')[1].toUpperCase() : '');\n        }\n\n        getFileName() {\n            return this.#$filename.text().trim();\n        }\n\n        setProgress(position, duration) {\n            if (position === undefined && duration === undefined) {\n                this.#$position.html('&hellip;');\n                this.#$duration.html('&hellip;');\n                return;\n            }\n            const\n                pos = position || 0,\n                dur = duration || 0;\n            this.#$position.text(new Duration(pos));\n            this.#$duration.text(new Duration(dur));\n            this.updateSeek(pos, dur);\n        }\n\n        setLoaded(timeRanges, duration) {\n            this.#$progressLoaded.empty();\n            for (let i = 0; i < timeRanges.length; i++) {\n                const\n                    start = timeRanges.start(i),\n                    end = timeRanges.end(i);\n                this.#$progressLoaded.append($.mk('div').css({\n                    left: floatToPercent(start / duration),\n                    width: floatToPercent((end - start) / duration),\n                }));\n            }\n        }\n\n        /**\n         * @param {LRCString[]} entries\n         * @param {float}       duration\n         */\n        setEntries(entries, duration) {\n            this.#$entrySticks.empty();\n            $.each(entries, (_, el) => {\n                this.#$entrySticks.append($.mk('div').css({\n                    left: floatToPercent(el.ts.seconds / duration),\n                }));\n            });\n        }\n\n        updateSeek(pos, dur) {\n            const perc = floatToPercent(pos / dur);\n            this.#$progressFill.css('width', perc);\n            this.#$thumb.css('left', perc);\n        }\n\n        showThumb(isPlaying) {\n            this.#$stateDiv[isPlaying ? 'addClass' : 'removeClass']('playing');\n        }\n    }\n\n    class AudioPlayer {\n        #$player;\n        #$filein;\n        #$audiofilebtn;\n        #audio;\n        #mediatags;\n        #volumeStep;\n        #$volumedisp;\n        #updateIndTimer;\n        #stateInd;\n\n        constructor() {\n            this.#$player = $('#player');\n            this.#$filein = $.mk('input', 'audiofilein').attr({\n                type: 'file',\n                accept: 'audio/*',\n                tabindex: -1,\n                'class': 'fileinput',\n            }).appendTo($body);\n\n            this.#$audiofilebtn = $('#audiofilebtn');\n            this.$playbackbtn = $('#playbackbtn');\n            this.#audio = new Audio();\n            this.#audio.preload = 'auto';\n            this.$stopbtn = $('#stopbtn');\n            $(this.#audio).on('ended', () => {\n                this.stop();\n                this.updatePlaybackButtons();\n            }).on('loadeddata', () => {\n                this.#stateInd.setProgress();\n                this.updateInd();\n                this.#$audiofilebtn.enable();\n                this.updatePlaybackButtons();\n                this.#stateInd.showThumb(true);\n                this.updateEntrySticks();\n                this.setMetadataLength();\n            });\n\n            this.#mediatags = {};\n\n            this.#volumeStep = 0.05;\n            this.#$volumedisp = $('#volumedisp');\n            this.$volumedown = $('#volumedown');\n            this.$volumeup = $('#volumeup');\n            let sessionVol = AudioPlayer.getSessionVolume();\n            this.volume(sessionVol);\n            this.updateVolumeButtons(sessionVol);\n\n            this.#updateIndTimer = undefined;\n            this.#stateInd = new AudioPlaybackIndicator(this.#$player.find('.state'));\n            let resumeOnRelease;\n            this.#stateInd.$progressWrap.on('mousedown', e => {\n                if (e.which !== 1 || !this.hasFile())\n                    return;\n\n                e.preventDefault();\n\n                this.#stateInd.$progressWrap.addClass('moving');\n                resumeOnRelease = !this.#audio.paused;\n                this.pause();\n                this.updatePlaybackButtons();\n            });\n            $d.on('mouseup', e => {\n                if (e.which !== 1 || !this.#stateInd.$progressWrap.hasClass('moving') || !this.hasFile())\n                    return;\n\n                this.recalcThumbPos(e);\n                this.#stateInd.$progressWrap.removeClass('moving');\n                if (resumeOnRelease) {\n                    this.play();\n                    this.updatePlaybackButtons();\n                }\n            });\n            $d.on('mousemove', $.throttle(100, e => {\n                if (!this.#stateInd.$progressWrap.hasClass('moving') || !this.hasFile())\n                    return;\n\n                this.recalcThumbPos(e);\n            }));\n\n            this.$stopbtn.on('click', e => {\n                e.preventDefault();\n\n                if (!this.hasFile())\n                    return;\n\n                this.stop();\n                this.updatePlaybackButtons();\n            });\n            this.$playbackbtn.on('click', e => {\n                e.preventDefault();\n\n                if (!this.hasFile())\n                    return;\n\n                if (this.#audio.paused)\n                    this.play();\n                else this.pause();\n                this.updatePlaybackButtons();\n            });\n            this.$volumedown.on('click', (e, shiftKey, altKey) => {\n                e.preventDefault();\n\n                const newvol = this.volume() - (e.altKey || altKey ? 0.01 : this.#volumeStep * (e.shiftKey || shiftKey ? 2 : 1));\n                this.updateVolumeButtons(newvol);\n                this.volume(newvol);\n            });\n            this.$volumeup.on('click', (e, shiftKey, altKey) => {\n                e.preventDefault();\n\n                const newvol = this.volume() + (e.altKey || altKey ? 0.01 : this.#volumeStep * (e.shiftKey || shiftKey ? 2 : 1));\n                this.updateVolumeButtons(newvol);\n                this.volume(newvol);\n            });\n            this.#$audiofilebtn.on('click', e => {\n                e.preventDefault();\n\n                this.#$filein.trigger('click');\n            });\n            this.#$filein.on('change', () => {\n                const val = this.#$filein.val();\n\n                if (!val)\n                    return;\n\n                this.clearFile();\n                this.#$audiofilebtn.disable();\n                this.setFile(this.#$filein[0].files[0], file => {\n                    this.#stateInd.setFileName(file.name, file.type);\n                });\n            });\n        }\n\n        /** @return {AudioPlayer} */\n        static getInstance() {\n            if (typeof pluginScope.player === 'undefined')\n                pluginScope.player = new AudioPlayer();\n            return pluginScope.player;\n        }\n\n        static getSessionVolume() {\n            if (!window.localStorage)\n                return 0.5;\n\n            let stored = localStorage.getItem('lrc-vol');\n            if (!stored || isNaN(stored)) {\n                stored = '0.5';\n                localStorage.setItem('lrc-vol', stored);\n            }\n\n            return parseFloat(stored);\n        }\n\n        volume(float) {\n            if (typeof float === 'undefined')\n                return this.#audio.volume;\n\n            float = $.rangeLimit($.roundTo(float, 2), false, 0, 1);\n            this.#$volumedisp.text($.pad(Math.round(float * 100), ' ', 3) + '%');\n            if (window.localStorage)\n                localStorage.setItem('lrc-vol', float);\n            this.#audio.volume = float;\n        }\n\n        updateVolumeButtons(newvol) {\n            this.$volumeup.attr('disabled', newvol >= 1);\n            this.$volumedown.attr('disabled', newvol <= 0);\n        }\n\n        updatePlaybackButtons() {\n            const fileMissing = !this.hasFile();\n            this.$playbackbtn.attr('disabled', fileMissing);\n            this.$stopbtn.attr('disabled', fileMissing);\n            TimingEditor.getInstance().disableModeButton(fileMissing);\n            this.$playbackbtn.removeClass('btn-success btn-danger').children().removeClass('fa-play fa-pause');\n            if (!this.#audio.paused)\n                this.$playbackbtn.addClass('btn-danger').children().addClass('fa-pause');\n            else this.$playbackbtn.addClass('btn-success').children().addClass('fa-play');\n        }\n\n        play() {\n            if (!this.#audio.paused)\n                return;\n\n            this.#audio.play();\n            this.#startUpdateIndTimer();\n            this.#stateInd.showThumb(true);\n        }\n\n        pause(skipIndUpd = false) {\n            this.#stopUpdateIndTimer();\n\n            if (this.#audio.paused)\n                return;\n            this.#audio.pause();\n            if (!skipIndUpd)\n                this.updateInd();\n        }\n\n        stop() {\n            this.pause(true);\n            this.#audio.currentTime = 0;\n            this.updateInd();\n        }\n\n        seek(seconds) {\n            if (!this.hasFile())\n                return;\n\n            this.#audio.currentTime = $.rangeLimit(this.#audio.currentTime + seconds, false, 0, this.#audio.duration);\n            this.updateInd();\n        }\n\n        /**\n         * @param {File} file\n         * @param {Function} callback\n         */\n        setFile(file, callback) {\n            this.stop();\n            this.#stateInd.showThumb(false);\n            this.updatePlaybackButtons();\n            if (!/^audio\\//.test(file.type)) {\n                $.Dialog.fail(Laravel.jsLocales.dialog_format_error, Laravel.jsLocales.dialog_format_notaudio);\n                return;\n            }\n            this.#audio.src = URL.createObjectURL(file);\n            new jsmediatags.Reader(file)\n                .setTagsToRead(['title', 'artist', 'album'])\n                .read({\n                    onSuccess: data => {\n                        if (typeof data === 'object') {\n                            this.setMediaTags(data.tags);\n                        }\n                    },\n                    onError: function (error) {\n                        console.log('Failed to read ID3 tags', error.type, error.info);\n                    }\n                });\n            callback(file);\n        }\n\n        hasFile() {\n            return this.#audio.readyState !== 0;\n        }\n\n        clearFile() {\n            this.stop();\n            if (this.#audio.src) {\n                URL.revokeObjectURL(this.#audio.src);\n            }\n            this.#audio.src = \"\";\n            this.clearMediaTags();\n        }\n\n        getFileName() {\n            const tags = this.#mediatags;\n            if (tags.title) {\n                if (tags.artist) {\n                    return `${tags.artist} - ${tags.title}`;\n                }\n                return tags.title;\n            }\n            return this.#stateInd.getFileName();\n        }\n\n        clearMediaTags() {\n            this.#mediatags = {};\n            TimingEditor.getInstance().setInitialMetadata({length: null});\n        }\n\n        setMediaTags(tags) {\n            if (typeof tags !== 'object')\n                throw new Error(`setMediaTags: tags must be an object, ${typeof tags} given.`);\n\n            this.#mediatags = tags;\n            TimingEditor.getInstance().setInitialMetadata(this.#mediatags);\n        }\n\n        getMediaTags() {\n            return this.#mediatags;\n        }\n\n        #startUpdateIndTimer() {\n            this.#stopUpdateIndTimer();\n            this.#updateIndTimer = setInterval(() => {\n                this.updateInd();\n            }, 85);\n        }\n\n        #stopUpdateIndTimer() {\n            if (typeof this.#updateIndTimer === 'undefined')\n                return;\n\n            clearInterval(this.#updateIndTimer);\n            this.#updateIndTimer = undefined;\n        }\n\n        updateInd() {\n            this.#stateInd.setProgress(this.#audio.currentTime, this.#audio.duration);\n            this.#stateInd.setLoaded(this.#audio.buffered, this.#audio.duration);\n            TimingEditor.getInstance().hlEntry(this.getPlaybackPosition());\n        }\n\n        updateEntrySticks() {\n            if (!this.hasFile())\n                return;\n\n            this.#stateInd.setEntries(TimingEditor.getInstance().getTimings(), this.#audio.duration);\n        }\n\n        setMetadataLength() {\n            TimingEditor.getInstance().setInitialMetadata({length: new Duration(this.#audio.duration, true)});\n        }\n\n        getPlaybackPosition() {\n            if (!this.hasFile())\n                return;\n\n            return new Duration(this.#audio.currentTime);\n        }\n\n        /** @param {string} ts */\n        setPlaybackPosition(ts) {\n            if (!this.hasFile() || !Duration.isValid(ts))\n                return;\n\n            this.#audio.currentTime = new Duration(ts).seconds;\n            this.updateInd();\n        }\n\n        recalcThumbPos(e) {\n            const\n                pwOffset = this.#stateInd.$progressWrap.offset(),\n                pwWidth = parseInt(this.#stateInd.$progressWrap.css('width'), 10),\n                relativeX = $.rangeLimit(e.clientX - pwOffset.left, false, 0, pwWidth - 0.00001);\n\n            this.#audio.currentTime = this.#audio.duration * (relativeX / pwWidth);\n            this.#stateInd.updateSeek(relativeX, pwWidth);\n            this.updateInd();\n        }\n    }\n\n    const LRC_META_TAGS = {\n        ar: 'artist',\n        ti: 'title',\n        al: 'album',\n        au: 'lyrics_author',\n        length: 'length',\n        by: 'file_author',\n        offset: 'offset',\n        re: 'created_with',\n        ve: 'version',\n    };\n    const LRC_TS_REGEX = /\\[([\\d:.]+)]/g;\n    const LRC_META_REGEX = new RegExp(`^\\\\\\[(${Object.keys(LRC_META_TAGS).join('|')}):([^\\\\\\]]+)]$`);\n\n    class LRCParser {\n        constructor(lrcfile) {\n            this.timings = [];\n            this.metadata = {};\n            const file = lrcfile.trim();\n            if (file.length === 0)\n                throw new Error(Laravel.jsLocales.dialog_parse_error_empty);\n            const lines = lrcfile.trim().split('\\n');\n            $.each(lines, (_, el) => {\n                const timestamps = el.match(LRC_TS_REGEX);\n                if (timestamps) {\n                    const text = el.replace(LRC_TS_REGEX, '');\n                    $.each(timestamps, (_, ts) => {\n                        this.timings.push(new LRCString(text, ts.substring(1, ts.length - 2)));\n                    });\n                } else {\n                    const trimmedEl = el.trim();\n                    const metadata = trimmedEl.match(LRC_META_REGEX);\n                    console.log(trimmedEl);\n                    if (metadata) {\n                        this.metadata[metadata[1]] = metadata[2];\n                    }\n                }\n            });\n            this.timings.sort((a, b) => a.ts.seconds - b.ts.seconds);\n        }\n    }\n\n    class MetadataEditingForm {\n        #$form;\n\n        constructor(compiledMetadata) {\n            this.#$form = $.mk('form', 'metadata-editing-form');\n            $.each(LRC_META_TAGS, (short, long) => {\n                const id = `meta_input_${short}`;\n                const inputAttrs = {\n                    type: 'text',\n                    name: short,\n                    id,\n                    value: compiledMetadata[short],\n                    'class': 'form-control',\n                };\n                if (short === 'offset') {\n                    inputAttrs.type = 'number';\n                    inputAttrs.step = '0.001';\n                    inputAttrs.min = '0';\n                    inputAttrs.placeholder = '0';\n                    if (inputAttrs.value === inputAttrs.placeholder)\n                        inputAttrs.value = '';\n                }\n                this.#$form.append(\n                    $.mk('div').attr('class', 'form-group').append(\n                        $.mk('label')\n                            .attr({\n                                'for': id,\n                            })\n                            .append(\n                                Laravel.jsLocales.metadata_field_placeholders[long],\n                                ` <code>${short}</code>`\n                            ),\n                        $.mk('input')\n                            .attr(inputAttrs)\n                    )\n                );\n            });\n            this.#$form.prepend(\n                $.mk('div').attr('class', ' alert alert-info text-center').append(\n                    $.mk('span').text(Laravel.jsLocales.dialog_edit_meta_reset_info),\n                    mk('br'),\n                    $.mk('button').attr({\n                        'class': 'btn btn-info',\n                        type: 'reset',\n                    }).text(Laravel.jsLocales.dialog_edit_meta_reset_btn).prepend('<i class=\"fa fa-undo\"/>')\n                )\n            );\n        }\n\n        get() {\n            return this.#$form.clone();\n        }\n    }\n\n    /** @property {LRCString[]} timings */\n    class TimingEditor {\n        #mergedOutputStrategy;\n        #$timings;\n        #$lrcmodebtn;\n        #$lrcfilebtn;\n        #$filein;\n        #$lrcpastebtn;\n        #$lrcexportbtn;\n        #$lrcexportnometabtn;\n        #$lrcmergetogglebtn;\n        #$lrcclrbtn;\n        #$lrcmetadatabtn;\n        #$editor;\n        #$entryTemplate;\n        #lastLRCFilename;\n        #mode;\n\n        constructor() {\n            this.#$timings = $('#timings');\n            this.#$lrcmodebtn = $('#lrcmodebtn');\n            this.#$lrcfilebtn = $('#lrcfilebtn');\n            this.#$filein = $.mk('input', 'lrcfilein').attr({\n                type: 'file',\n                accept: '.lrc',\n                tabindex: -1,\n                'class': 'fileinput'\n            }).appendTo($body);\n            this.#$lrcpastebtn = $('#lrcpastebtn');\n            this.#$lrcexportbtn = $('#lrcexportbtn');\n            this.#$lrcexportnometabtn = $('#lrcexportnometabtn');\n            this.#$lrcmergetogglebtn = $('#lrcmergetogglebtn');\n            this.#$lrcclrbtn = $('#lrcclrbtn');\n            this.#$lrcmetadatabtn = $('#lrcmetadatabtn');\n            this.#$editor = this.#$timings.find('.editor');\n            this.#$entryTemplate = $('#editor-entry-template').children();\n            this.changeMode('edit');\n            this.timings = [];\n            this.initialMetadata = {\n                offset: '0',\n                re: `${window.location.href} - SeinopSys' LRC Editor`,\n                ve: window.Laravel.git.commit_id,\n            };\n            this.metadata = {};\n            this.#$editor.append(this.makeEntryDiv(new LRCString()));\n\n            this.#lastLRCFilename = undefined;\n            this.#mergedOutputStrategy = TimingEditor.getMergedOutputStrategyDefault();\n            this.#updateMergeStrategyButton();\n\n            this.#$lrcmodebtn.on('click', e => {\n                e.preventDefault();\n\n                if (this.#$lrcmodebtn.is('[disabled]'))\n                    return;\n\n                this.changeMode(null, e.altKey);\n            });\n            this.#$lrcpastebtn.on('click', e => {\n                e.preventDefault();\n\n                const $form = $.mk('form', 'rawlyrics').append(\n                    `<div class=\"form-group\">\n\t\t\t\t\t\t<textarea class=\"form-control\" rows=\"10\"></textarea>\n\t\t\t\t\t</div>\n\t\t\t\t\t<p class=\"text-info\"><span class=\"fa fa-info-circle\"></span> ${Laravel.jsLocales.dialog_pasteraw_info}</p>`\n                );\n                $.Dialog.request(Laravel.jsLocales.dialog_pasteraw_title, $form, Laravel.jsLocales.dialog_pasteraw_action, $form => {\n                    $form.on('submit', e => {\n                        e.preventDefault();\n\n                        $.Dialog.wait(false, 'Importing');\n                        const lines = $form.find('textarea').val().trim().split(/\\n+/g);\n                        lines.push(''); // Add an empty line to account for an outro\n                        this.timings = lines.map(el => new LRCString(el));\n                        AudioPlayer.getInstance().updateEntrySticks();\n                        this.regenEntries();\n                        this.#lastLRCFilename = undefined;\n\n                        $.Dialog.close();\n                    });\n                });\n            });\n            this.#$lrcexportbtn.on('click', e => {\n                e.preventDefault();\n\n                this.storeTimings();\n                this.exportLRCFile();\n            });\n            this.#$lrcexportnometabtn.on('click', e => {\n                e.preventDefault();\n\n                this.storeTimings();\n                this.exportLRCFile(false);\n            });\n            this.#$lrcmergetogglebtn.on('click', e => {\n                e.preventDefault();\n\n                this.#toggleMergeStrategy();\n            });\n            this.#$lrcclrbtn.on('click', e => {\n                e.preventDefault();\n\n                $.Dialog.confirm($(e.target).text(), undefined, sure => {\n                    if (!sure) return;\n\n                    this.#$editor.empty();\n                    this.#$editor.append(this.makeEntryDiv(new LRCString()));\n                    this.storeTimings();\n                    $.Dialog.close();\n                });\n            });\n            this.#$lrcmetadatabtn.on('click', e => {\n                e.preventDefault();\n\n                const $form = new MetadataEditingForm(this.getCurrentMetadata()).get();\n                $.Dialog.request(Laravel.jsLocales.dialog_edit_meta, $form, Laravel.jsLocales.save, () => {\n                    $form.on('submit', e => {\n                        e.preventDefault();\n\n                        const data = $form.mkData();\n                        $.each(LRC_META_TAGS, key => {\n                            this.metadata[key] = data[key].trim();\n                        });\n                        $.Dialog.close();\n                    });\n                    $form.on('reset', e => {\n                        e.preventDefault();\n\n                        this.metadata = {};\n                        const newMetadata = this.getCurrentMetadata();\n                        $.each(LRC_META_TAGS, key => {\n                            $form.find(`input[name=${key}]`).val(newMetadata[key]);\n                        });\n                    });\n                });\n            });\n            this.#$editor.on('mouseenter', () => {\n                this.#$editor.stop();\n            });\n            this.#$editor.on('keyup', '.timestamp', e => {\n                if (this.#mode !== 'edit')\n                    return;\n\n                const\n                    $ts = $(e.target),\n                    val = $ts.text().trim(),\n                    valInvalid = !Duration.isValid(val);\n                $ts[val.length && valInvalid ? 'addClass' : 'removeClass']('invalid');\n                $ts.siblings('.tools').children('.goto').attr('disabled', valInvalid);\n                AudioPlayer.getInstance().updateEntrySticks();\n            });\n            this.#$editor.on('click', '.addrow-up, .addrow-down', e => {\n                e.preventDefault();\n\n                const insertWhere = $(e.target).closest('button').attr('class').match(/addrow-(up|down)/)[1] === 'up' ? 'insertBefore' : 'insertAfter';\n                const $entry = this.makeEntryDiv(new LRCString())[insertWhere]($(e.target).closest('.time-entry'));\n                this.updateEntryActionButtons();\n                this.storeTimings();\n                $entry.addClass('new');\n                this.scrollHighlightedIntoView($entry, false);\n            });\n            this.#$editor.on('click', '.remrow', e => {\n                e.preventDefault();\n\n                const $entry = $(e.target).closest('.time-entry');\n                if ($entry.siblings().length === 0)\n                    return;\n\n                $entry.remove();\n                this.updateEntryActionButtons();\n                this.storeTimings();\n                this.hlEntry(AudioPlayer.getInstance().getPlaybackPosition());\n            });\n            this.#$editor.on('click', '.goto', e => {\n                e.preventDefault();\n\n                const $button = $(e.target).closest('.goto');\n                if ($button.is(':disabled'))\n                    return;\n\n                const $entry = $button.parents('.time-entry');\n                const ts = $entry.find('.timestamp').text();\n                AudioPlayer.getInstance().setPlaybackPosition(ts);\n\n                if (this.#mode === 'sync')\n                    this.passSyncHandle($entry);\n            });\n            this.#$lrcfilebtn.on('click', e => {\n                e.preventDefault();\n\n                this.#$filein.trigger('click');\n            });\n            this.#$filein.on('change', () => {\n                const val = this.#$filein.val();\n\n                if (!val) return;\n\n                this.#$lrcfilebtn.disable();\n                this.readLRCFile(this.#$filein[0].files[0], success => {\n                    if (success)\n                        this.regenEntries();\n                    else this.#$filein.val('');\n                    this.#$lrcfilebtn.enable();\n                });\n            });\n        }\n\n        /** @return {TimingEditor} */\n        static getInstance() {\n            if (typeof pluginScope.editor === 'undefined')\n                pluginScope.editor = new TimingEditor();\n            return pluginScope.editor;\n        }\n\n        disableModeButton(disable) {\n            this.#$lrcmodebtn.attr('disabled', disable);\n        }\n\n        changeMode(mode = null, preservePosition = false) {\n            if (mode === null)\n                mode = this.#mode === 'sync' ? 'edit' : 'sync';\n            else if ($.inArray(mode, ['sync', 'edit']) === -1)\n                throw new Error('Invalid mode: ' + mode);\n            if (this.#mode === mode)\n                return;\n\n            const $children = this.#$lrcmodebtn.children();\n            const modeIcon = ({edit: 'edit', sync: 'time'})[mode];\n            const otherMode = mode === 'sync' ? 'edit' : 'sync';\n            const otherIcon = mode === 'sync' ? 'edit' : 'clock';\n            $children.first().removeClass(`fa-${modeIcon}`).addClass(`fa-${otherIcon}`).next().text(this.#$lrcmodebtn.attr(`data-${otherMode}mode`));\n            this.#$editor.removeClass(`mode-${otherMode}`).addClass(`mode-${mode}`);\n            this.#mode = mode;\n\n            switch (this.#mode) {\n                case \"edit\":\n                    this.revokeSyncHandle();\n                    this.#$editor.find('.text, .timestamp').attr('contenteditable', true);\n                    this.#$editor.find('.sync-handle').removeClass('sync-handle');\n                    break;\n                case \"sync\":\n                    this.#$editor.find('.text, .timestamp').removeAttr('contenteditable');\n                    const $handle = this.getSyncHandle(preservePosition);\n                    this.scrollHighlightedIntoView($handle, false);\n                    break;\n            }\n        }\n\n        getTimings() {\n            return this.timings;\n        }\n\n        setTimings(timings) {\n            this.timings = timings;\n            this.regenEntries();\n            AudioPlayer.getInstance().updateEntrySticks();\n        }\n\n        setInitialMetadata(metadata) {\n            $.each(['ar', 'ti', 'al', 'length'], (_, el) => {\n                const long = LRC_META_TAGS[el];\n                if (metadata[long])\n                    this.initialMetadata[el] = metadata[long];\n                else if (metadata[long] === null)\n                    delete this.initialMetadata[el];\n            });\n        }\n\n        setMetadata(metadata) {\n            this.metadata = metadata;\n        }\n\n        getCurrentMetadata() {\n            return $.extend({}, this.initialMetadata, this.metadata);\n        }\n\n        storeTimings() {\n            const $children = this.#$editor.children();\n            let timings = [];\n            $children.each(function () {\n                const\n                    $entry = $(this),\n                    ts = $entry.children('.timestamp').text().trim();\n                if (!ts.length || !Duration.isValid(ts))\n                    return;\n\n                const text = $entry.children('.text').text().trim().split('\\n');\n\n                $.each(text, (_, el) => {\n                    timings.push(new LRCString(\n                        el,\n                        ts,\n                        $entry\n                    ));\n                });\n            });\n            this.timings = timings;\n            AudioPlayer.getInstance().updateEntrySticks();\n        }\n\n        makeEntryDiv(lrcstring) {\n            const $clone = this.#$entryTemplate.clone();\n            $clone.children().first().text(lrcstring.ts.toString()).trigger('keyup').next().text(lrcstring.str);\n            return $clone;\n        }\n\n        regenEntries() {\n            this.#$editor.empty();\n            $.each(this.timings, (i, el) => {\n                this.timings[i].$domNode = this.makeEntryDiv(el);\n                this.#$editor.append(this.timings[i].$domNode);\n            });\n            this.passSyncHandle(this.#$editor.children().first());\n            this.updateEntryActionButtons();\n        }\n\n        updateEntryActionButtons() {\n            const $entries = this.#$editor.children();\n            $entries.find('.remrow').attr('disabled', $entries.length === 1);\n            $entries.find('.goto').disable().filter(function () {\n                return Duration.isValid($(this).parent().siblings().first().text().trim());\n            }).enable();\n        }\n\n        readLRCFile(file, callback) {\n            const reader = new FileReader();\n            reader.onload = () => {\n                try {\n                    const parsed = new LRCParser(reader.result);\n                    this.setTimings(parsed.timings);\n                    this.setMetadata(parsed.metadata);\n                } catch (e) {\n                    $.Dialog.fail(Laravel.jsLocales.dialog_parse_error, e.message);\n                    callback(false);\n                    return;\n                }\n                this.#lastLRCFilename = file.name.replace(/\\.lrc$/, '');\n                callback(true);\n            };\n            reader.readAsText(file);\n        }\n\n        static giveSyncHandleTo($el) {\n            $el.addClass('sync-handle');\n            $el.find('.timestamp').focus();\n            return $el;\n        }\n\n        getSyncHandle(nowplayingAsHandle = false) {\n            if (this.#mode === 'edit')\n                return;\n\n            const $children = this.#$editor.children();\n            if (!$children.length)\n                return;\n\n            let $handle = this.#$editor.children('.sync-handle');\n            const $nowplaying = this.#$editor.children('.nowplaying').removeClass('nowplaying');\n            if (nowplayingAsHandle && !$handle.length) {\n                $handle = $nowplaying;\n                if ($handle.length)\n                    $handle.addClass('sync-handle');\n            }\n            if (!$handle.length)\n                $handle = TimingEditor.giveSyncHandleTo(this.#$editor.children().first());\n            return $handle;\n        }\n\n        revokeSyncHandle() {\n            const $current = this.getSyncHandle();\n            if (typeof $current !== 'undefined')\n                $current.removeClass('sync-handle nowplaying').removeAttr('title');\n\n            return $current;\n        }\n\n        passSyncHandle($next = null, resetOnEnd = true) {\n            if (this.#mode === 'edit')\n                return;\n\n            const $current = this.revokeSyncHandle();\n\n            if ($next === null)\n                $next = $current.next();\n\n            if (!$next.length) {\n                if (resetOnEnd) {\n                    this.changeMode('edit');\n                    return;\n                }\n                $next = $current;\n            }\n\n            TimingEditor.giveSyncHandleTo($next);\n            this.scrollHighlightedIntoView($next, false);\n        }\n\n        syncEntry(writeTs = true, resetOnEnd = true) {\n            if (this.#mode === 'edit')\n                return;\n\n            const\n                $handle = this.getSyncHandle(),\n                pos = AudioPlayer.getInstance().getPlaybackPosition();\n\n            if (writeTs) {\n                const $prevTs = $handle.prev().find('.timestamp');\n                if ($prevTs.text().trim() === pos) {\n                    $prevTs.removeClass('flash').addClass('flash');\n                    return;\n                }\n\n                $handle.find('.timestamp').text(pos).trigger('keyup');\n            }\n            this.passSyncHandle(null, resetOnEnd);\n            this.storeTimings();\n            this.updateEntryActionButtons();\n            AudioPlayer.getInstance().updateEntrySticks();\n        }\n\n        syncBreakEntry() {\n            if (this.#mode === 'edit')\n                return;\n\n            const\n                $handle = this.getSyncHandle(),\n                pos = AudioPlayer.getInstance().getPlaybackPosition();\n\n            this.makeEntryDiv(new LRCString('', pos)).insertBefore($handle).find('[contenteditable]').removeAttr('contenteditable');\n            this.scrollHighlightedIntoView($handle, false);\n            this.updateEntryActionButtons();\n            this.storeTimings();\n            AudioPlayer.getInstance().updateEntrySticks();\n        }\n\n        undoSync() {\n            if (this.#mode === 'edit')\n                return;\n\n            const $handle = this.getSyncHandle();\n            if ($handle.index() === 0)\n                return;\n            this.passSyncHandle($handle.prev());\n            this.storeTimings();\n            this.updateEntryActionButtons();\n            AudioPlayer.getInstance().updateEntrySticks();\n        }\n\n        emptySync() {\n            if (this.#mode === 'edit')\n                return;\n\n            const $handle = this.getSyncHandle();\n            $handle.find('.timestamp').empty().trigger('keyup');\n            this.passSyncHandle();\n            this.storeTimings();\n            AudioPlayer.getInstance().updateEntrySticks();\n        }\n\n        /** @vparam {Duration} position */\n        hlEntry(position) {\n            if (this.#mode === 'sync' || typeof position === 'undefined')\n                return;\n\n            const usableTimings = this.getTimings();\n            const i = binarySearch(usableTimings, n => n.ts.seconds - position.seconds);\n            if (i < 0) {\n                $('.nowplaying').removeClass('nowplaying');\n                return;\n            }\n\n            const $hl = usableTimings[i].$domNode;\n            if ($hl.hasClass('nowplaying'))\n                return;\n\n            this.scrollHighlightedIntoView($hl);\n        }\n\n        scrollHighlightedIntoView($hl, highlight = true) {\n            if (highlight)\n                $hl.addClass('nowplaying').siblings().removeClass('nowplaying');\n\n            if (this.#$editor.is(':hover'))\n                return;\n\n            const\n                hlpos = $hl.position(),\n                edpos = this.#$editor.position(),\n                scrl = this.#$editor.scrollTop();\n\n            const newscrl = scrl + (hlpos.top - edpos.top) - (this.#$editor.height() / 2) + ($hl.height() / 2);\n            this.#$editor.stop().animate({scrollTop: newscrl}, 400);\n        }\n\n        /**\n         * Grab last value from local storage and use if available\n         * @returns {boolean}\n         */\n        static getMergedOutputStrategyDefault() {\n            if (!window.localStorage)\n                return true;\n\n            let stored = localStorage.getItem('lrc-merge');\n            if (!stored || stored !== 'false') {\n                stored = 'true';\n                localStorage.setItem('lrc-merge', stored);\n            }\n\n            return stored === 'true';\n        }\n\n        #toggleMergeStrategy() {\n            this.#mergedOutputStrategy = !this.#mergedOutputStrategy;\n            if (window.localStorage)\n                localStorage.setItem('lrc-merge', this.#mergedOutputStrategy ? 'true' : 'false');\n            this.#updateMergeStrategyButton();\n        }\n\n        #updateMergeStrategyButton() {\n            const $status = this.#$lrcmergetogglebtn.find('.status');\n            if (this.#mergedOutputStrategy) {\n                $status.addClass('text-success').removeClass('text-danger');\n            } else {\n                $status.removeClass('text-success').addClass('text-danger');\n            }\n            $status.text($status.attr(`data-${this.#mergedOutputStrategy ? 'true' : 'false'}`));\n        }\n\n        exportLRCFile(includeMetadata = true) {\n            let outputArr = [];\n            if (includeMetadata) {\n                const metadata = this.getCurrentMetadata();\n                $.each(metadata, (k, v) => {\n                    if (v !== '') {\n                        switch (k) {\n                            case 'offset':\n                                if (v === '0')\n                                    return;\n                                break;\n                            case 'length':\n                                v = ` ${v}`;\n                                break;\n                        }\n                        outputArr.push(`[${k}:${v}]`);\n                    }\n                });\n            }\n            if (this.#mergedOutputStrategy) {\n                const strings = {};\n                $.each(this.timings, (i, el) => {\n                    if (typeof strings[el.str] === 'undefined')\n                        strings[el.str] = [];\n\n                    strings[el.str].push(el.ts.toString(true));\n                });\n                $.each(strings, (str, tsArr) => {\n                    outputArr.push(`[${tsArr.join('][')}]${str}`);\n                });\n            } else {\n                outputArr = [\n                    ...outputArr,\n                    ...this.timings.map(el => `[${el.ts.toString(true)}]${el.str}`),\n                ];\n            }\n            const output = outputArr.join('\\n') + '\\n';\n            const basename = this.#lastLRCFilename || AudioPlayer.getInstance().getFileName() || 'Lyrics';\n            const filename = `${basename}.lrc`;\n\n            const blob = new Blob([output], {type: \"text/plain;charset=utf-8\"});\n            saveAs(blob, filename);\n        }\n    }\n\n    // Create instances\n    AudioPlayer.getInstance();\n    TimingEditor.getInstance();\n\n    $d.on('keydown', $.throttle(200, function (e) {\n        const tagname = e.target.tagName.toLowerCase();\n        if ((tagname === 'input' && e.target.type !== 'file') || tagname === 'textarea' || e.target.getAttribute('contenteditable') !== null)\n            return;\n\n        switch (e.keyCode) {\n            case Key.LeftArrow:\n                pluginScope.player.seek(-2.5 * (e.shiftKey ? 2 : 1));\n                break;\n            case Key.RightArrow:\n                pluginScope.player.seek(2.5 * (e.shiftKey ? 2 : 1));\n                break;\n            case Key.PageUp:\n                pluginScope.player.$volumeup.trigger('click', [e.shiftKey, e.altKey]);\n                break;\n            case Key.PageDown:\n                pluginScope.player.$volumedown.trigger('click', [e.shiftKey, e.altKey]);\n                break;\n            case Key.Space:\n                pluginScope.player.$playbackbtn.trigger('click');\n                break;\n            case Key.Period:\n                pluginScope.player.$stopbtn.trigger('click');\n                break;\n            case Key.Enter:\n                if (e.ctrlKey && !e.altKey)\n                    pluginScope.editor.syncBreakEntry();\n                else pluginScope.editor.syncEntry();\n                break;\n            case Key.UpArrow:\n                pluginScope.editor.undoSync();\n                break;\n            case Key.DownArrow:\n                pluginScope.editor.syncEntry(false, false);\n                break;\n            case Key.Delete:\n                pluginScope.editor.emptySync();\n                break;\n            default:\n                return;\n        }\n\n        e.preventDefault();\n    }));\n\n    // http://stackoverflow.com/a/17545260/1344955\n    $d.on('paste', '[contenteditable]', function (e) {\n        let text = '';\n        let $this = $(this);\n\n        if (e.clipboardData)\n            text = e.clipboardData.getData('text/plain');\n        else if (window.clipboardData)\n            text = window.clipboardData.getData('Text');\n        else if (e.originalEvent.clipboardData)\n            text = $.mk('div').text(e.originalEvent.clipboardData.getData('text'));\n\n        if (document.queryCommandSupported('insertText')) {\n            document.execCommand('insertHTML', false, $(text).html());\n            return false;\n        } else {\n            $this.find('*').each(function () {\n                $(this).addClass('within');\n            });\n\n            setTimeout(function () {\n                $this.find('*').each(function () {\n                    $(this).not('.within').contents().unwrap();\n                });\n            }, 1);\n        }\n    }).on('keyup', '[contenteditable]', function () {\n        const $this = $(this);\n        if ($this.text().trim().length === 0)\n            $this.empty();\n    });\n\n    const $ist = $('#info-shortcuts-template');\n    if (typeof navigator.userAgent === 'string' && /(macos|iphone|os ?x|ip[ao]d)/i.test(navigator.userAgent)) {\n        $ist.find('kbd:contains(Shift)').html(`&#x2325;`);\n        $ist.find('kbd:contains(Ctrl)').html(`&#x2318;`);\n    }\n    $('#shortcut-info').on('click', function (e) {\n        e.preventDefault();\n\n        const title = $(this).attr('title');\n        $.Dialog.info(title, $ist.clone().children());\n    });\n\n    window.Plugin = pluginScope;\n})(jQuery);\n"]}